<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>InfoScope-DW - Your Browser & System Information</title>
    <!-- Google Font: Share Tech Mono -->
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <!-- jsPDF library for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
        :root {
            --primary-color: #4a6da7;
            --secondary-color: #304878;
            --accent-color: #8ab4f8;
            --background-color: #f9fafb;
            --card-color: #ffffff;
            --text-color: #333333;
            --text-light: #666666;
            --border-color: #e5e7eb;
            --success-color: #34c759;
            --danger-color: #ff3b30;
            --font-family: 'Share Tech Mono', monospace;
            --shimmer-bg: #f0f0f0;
            --shimmer-highlight: rgba(255, 255, 255, 0.8);
        }
        
        [data-theme="dark"] {
            --primary-color: #5d8adb;
            --secondary-color: #3a5a9c;
            --accent-color: #9fc3ff;
            --background-color: #121212;
            --card-color: #1e1e1e;
            --text-color: #ffffff;     /* Increased from #e4e4e4 for better contrast */
            --text-light: #bebebe;     /* Increased from #a0a0a0 for better contrast */
            --border-color: #3c3c3c;   /* Slightly lighter for better definition */
            --shimmer-bg: #2a2a2a;
            --shimmer-highlight: rgba(100, 100, 100, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 0;
            margin: 0;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem 1rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1.1rem;
            font-weight: 300;
            opacity: 0.9;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .cards-container {
            display: grid;
            display: -ms-grid; /* For IE support */
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            -ms-grid-columns: repeat(auto-fill, minmax(300px, 1fr)); /* For IE support */
            gap: 1.5rem;
            grid-gap: 1.5rem; /* Fallback for older browsers */
            width: 100%;
            box-sizing: border-box;
        }

        .card {
            background-color: var(--card-color);
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }

        .card-title {
            font-size: 1.25rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        [data-theme="dark"] .card-title {
            color: var(--accent-color); /* Brighter blue in dark mode for better visibility */
        }

        .card-title svg {
            width: 20px;
            height: 20px;
        }

        .info-item {
            margin-bottom: 0.75rem;
            display: flex;
            align-items: baseline;
        }

        .info-label {
            font-weight: 600;
            min-width: 180px;
            color: var(--text-light);
        }
        
        /* Make labels more visible in dark mode */
        [data-theme="dark"] .info-label {
            color: var(--text-color);
            opacity: 0.9;
        }

        .info-value {
            word-break: break-word;
        }

        .shimmer {
            background: linear-gradient(90deg, var(--shimmer-bg) 25%, var(--shimmer-highlight) 50%, var(--shimmer-bg) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            height: 1rem;
            width: 100%;
            border-radius: 4px;
        }

        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }

        .error-message {
            color: var(--danger-color);
            font-size: 0.9rem;
            margin-top: 0.25rem;
        }

        .list-container {
            margin-top: 0.5rem;
        }

        .list-item {
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .list-item:last-child {
            border-bottom: none;
        }

        .action-bar {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 1.5rem;
            gap: 1rem;
        }
        
        .action-bar-bottom {
            justify-content: center;
            margin-top: 2rem;
            margin-bottom: 0;
        }

        .action-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 0.75rem 1.25rem;
            font-size: 1.1rem;
            font-weight: 500;
            font-family: var(--font-family);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);
        }
        
        #download-pdf-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }
        
        #download-text-btn {
            background: linear-gradient(135deg, #4b6cb7, #182848);
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
            filter: brightness(1.1);
        }

        .action-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        .action-button svg {
            width: 20px;
            height: 20px;
        }

        footer {
            text-align: center;
            padding: 2rem 1rem;
            background-color: var(--card-color);
            margin-top: 2rem;
            border-top: 1px solid var(--border-color);
            position: relative;
        }
        
        /* Improve footer text contrast in dark mode */
        [data-theme="dark"] footer {
            color: var(--text-color);
        }
        
        .theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--card-color);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .theme-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .theme-toggle svg {
            width: 24px;
            height: 24px;
            color: var(--text-color);
        }
        
        /* Chart styles */
        .chart-container {
            width: 100%;
            height: 250px;
            margin-top: 1rem;
        }
        
        /* Browser Cache Dashboard styles */
        .cache-dashboard {
            background: linear-gradient(135deg, #6a85b6 0%, #bac8e0 100%);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            color: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        [data-theme="dark"] .cache-dashboard {
            background: linear-gradient(135deg, #304878 0%, #4e6491 100%);
        }
        
        .cache-dashboard-title {
            font-size: 1.8rem;
            margin-bottom: 1.2rem;
            font-weight: 700;
            text-align: center;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .tabs-cache-info {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 1rem;
        }
        
        .tabs-cache-item {
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 0.8rem 1.2rem;
            margin-bottom: 0.8rem;
            transition: transform 0.2s ease;
        }
        
        .tabs-cache-item:hover {
            transform: translateY(-2px);
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        .tabs-cache-name {
            font-weight: 700;
            margin-right: 1rem;
        }
        
        .tabs-cache-state {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }
        
        .state-active {
            background-color: #4ade80;
            color: #064e3b;
        }
        
        .state-inactive {
            background-color: #f87171;
            color: #7f1d1d;
        }
        
        .tabs-cache-size {
            float: right;
            font-weight: 600;
        }
        
        .cache-storage-summary {
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            padding: 1rem;
            font-size: 1.1rem;
            text-align: center;
            margin-top: 1rem;
        }
        
        /* Make sure ApexCharts works well in dark mode */
        [data-theme="dark"] .apexcharts-legend-text,
        [data-theme="dark"] .apexcharts-text,
        [data-theme="dark"] .apexcharts-title-text,
        [data-theme="dark"] .apexcharts-legend-marker,
        [data-theme="dark"] .apexcharts-tooltip-text,
        [data-theme="dark"] .apexcharts-datalabel-label,
        [data-theme="dark"] .apexcharts-datalabel-value {
            fill: var(--text-color) !important;
            color: var(--text-color) !important;
            text-shadow: none !important;
        }
        
        /* Remove text shadows from all chart elements */
        .apexcharts-text,
        .apexcharts-legend-text,
        .apexcharts-title-text,
        .apexcharts-tooltip-text,
        .apexcharts-datalabel-label,
        .apexcharts-datalabel-value {
            text-shadow: none !important;
        }
        
        /* Ensure ApexCharts tooltip has good contrast in dark mode */
        [data-theme="dark"] .apexcharts-tooltip {
            background-color: rgba(30, 30, 30, 0.95) !important;
            border-color: var(--accent-color) !important;
        }
        
        /* Ensure chart containers have the right text color */
        [data-theme="dark"] .chart-container {
            color: var(--text-color) !important;
        }

        /* Responsive design for different screen sizes */
        @media screen and (max-width: 768px) {
            .cards-container {
                grid-template-columns: 1fr;
                -ms-grid-columns: 1fr;
                display: flex;
                flex-direction: column;
            }
            
            .card {
                width: 100%;
                margin-bottom: 1.5rem;
            }

            .info-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .info-label {
                margin-bottom: 0.25rem;
                min-width: 100%;
            }
            
            .action-bar {
                justify-content: center;
                flex-direction: column;
                align-items: center;
            }
            
            .action-button {
                width: 100%;
                margin-bottom: 0.5rem;
            }
            
            .chart-container {
                height: 300px;
            }
        }
        
        /* Fix for very small screens */
        @media screen and (max-width: 480px) {
            h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .card-title {
                font-size: 1.1rem;
            }
            
            .container {
                padding: 0 0.75rem;
                margin: 1.5rem auto;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>InfoScope-DW</h1>
        <p class="subtitle">Your comprehensive browser and system information</p>
    </header>

    <div class="container">
        <!-- Browser Cache Dashboard - Full Width -->
        <div class="cache-dashboard">
            <h2 class="cache-dashboard-title">Browser Cache Dashboard</h2>
            <div class="tabs-cache-info" id="tabs-cache-info">
                <div class="shimmer" style="height: 2rem;"></div>
            </div>
            <div class="cache-storage-summary" id="cache-storage-summary">
                <div class="shimmer" style="height: 1.5rem; margin-top: 1rem;"></div>
            </div>
        </div>
        
        <div class="cards-container">
            <!-- Location Information Card -->
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-map-pin"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                    Location Information
                </h2>
                <div class="info-item">
                    <span class="info-label">IP Address:</span>
                    <span id="ip-address" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Location:</span>
                    <span id="location" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Hostname:</span>
                    <span id="hostname" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">ISP:</span>
                    <span id="isp" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
            </div>

            <!-- System Information Card -->
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-cpu"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><rect x="9" y="9" width="6" height="6"></rect><line x1="9" y1="1" x2="9" y2="4"></line><line x1="15" y1="1" x2="15" y2="4"></line><line x1="9" y1="20" x2="9" y2="23"></line><line x1="15" y1="20" x2="15" y2="23"></line><line x1="20" y1="9" x2="23" y2="9"></line><line x1="20" y1="14" x2="23" y2="14"></line><line x1="1" y1="9" x2="4" y2="9"></line><line x1="1" y1="14" x2="4" y2="14"></line></svg>
                    System Information
                </h2>
                <div class="info-item">
                    <span class="info-label">Operating System:</span>
                    <span id="os" class="info-value"></span>
                </div>
                <div class="info-item">
                    <span class="info-label">Browser:</span>
                    <span id="browser" class="info-value"></span>
                </div>
                <div class="info-item">
                    <span class="info-label">Screen Resolution:</span>
                    <span id="resolution" class="info-value"></span>
                </div>
                <div class="info-item">
                    <span class="info-label">Browser Size:</span>
                    <span id="browser-size" class="info-value"></span>
                </div>
                <div class="info-item">
                    <span class="info-label">Color Depth:</span>
                    <span id="color-depth" class="info-value"></span>
                </div>
                <div class="info-item">
                    <span class="info-label">Page Views:</span>
                    <span id="page-views" class="info-value"></span>
                </div>
            </div>

            <!-- Language & PDF Information Card -->
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-globe"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>
                    Languages & PDF
                </h2>
                <div class="info-item">
                    <span class="info-label">Languages Supported:</span>
                    <span id="languages" class="info-value"></span>
                </div>
                <div class="info-item">
                    <span class="info-label">Default PDF Viewer:</span>
                    <span id="pdf-viewer" class="info-value"></span>
                </div>
            </div>

            <!-- Plugins Information Card -->
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-package"><line x1="16.5" y1="9.4" x2="7.5" y2="4.21"></line><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>
                    Browser Plugins
                </h2>
                <div id="plugins-container" class="list-container">
                    <div class="shimmer" style="margin-bottom: 8px;"></div>
                    <div class="shimmer" style="margin-bottom: 8px;"></div>
                    <div class="shimmer"></div>
                </div>
            </div>
            
            <!-- Hardware & Basic Network Card -->
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-cpu"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><rect x="9" y="9" width="6" height="6"></rect><line x1="9" y1="1" x2="9" y2="4"></line><line x1="15" y1="1" x2="15" y2="4"></line><line x1="9" y1="20" x2="9" y2="23"></line><line x1="15" y1="20" x2="15" y2="23"></line><line x1="20" y1="9" x2="23" y2="9"></line><line x1="20" y1="14" x2="23" y2="14"></line><line x1="1" y1="9" x2="4" y2="9"></line><line x1="1" y1="14" x2="4" y2="14"></line></svg>
                    Hardware & Basic Network
                </h2>
                <div class="info-item">
                    <span class="info-label">Battery Status:</span>
                    <span id="battery-status" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Device Memory:</span>
                    <span id="device-memory" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">CPU Cores:</span>
                    <span id="cpu-cores" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Connection Type:</span>
                    <span id="connection-type" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
            </div>
            
            <!-- Detailed Network Metrics Card -->
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-wifi"><path d="M5 12.55a11 11 0 0 1 14.08 0"></path><path d="M1.42 9a16 16 0 0 1 21.16 0"></path><path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path><line x1="12" y1="20" x2="12.01" y2="20"></line></svg>
                    Detailed Network Metrics
                </h2>
                <div class="info-item">
                    <span class="info-label">Network Type:</span>
                    <span id="network-type" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Connection Speed:</span>
                    <span id="connection-speed" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Network Latency:</span>
                    <span id="network-latency" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Data Saver Mode:</span>
                    <span id="save-data" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
            </div>
            
            <!-- Browser Capabilities Card -->
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-settings"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                    Browser Capabilities
                </h2>
                <div class="info-item">
                    <span class="info-label">WebGL Support:</span>
                    <span id="webgl-support" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Graphics Card:</span>
                    <span id="graphics-card" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Media Support:</span>
                    <span id="media-support" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">WebRTC Support:</span>
                    <span id="webrtc-support" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
            </div>
            
            <!-- Privacy & Security Card -->
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-shield"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                    Privacy & Security
                </h2>
                <div class="info-item">
                    <span class="info-label">Do Not Track:</span>
                    <span id="do-not-track" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Ad Blocker Detection:</span>
                    <span id="ad-blocker" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Incognito/Private Mode:</span>
                    <span id="incognito-mode" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Cookies Enabled:</span>
                    <span id="cookies-enabled" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Cache Storage:</span>
                    <span id="cache-storage" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Local Storage Size:</span>
                    <span id="local-storage-size" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">IndexedDB Support:</span>
                    <span id="indexeddb-support" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
            </div>
            
            <!-- Accessibility & Preferences Card -->
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-eye"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                    Accessibility & Preferences
                </h2>
                <div class="info-item">
                    <span class="info-label">Color Scheme:</span>
                    <span id="color-scheme" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Reduced Motion:</span>
                    <span id="reduced-motion" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Font Size Adjusted:</span>
                    <span id="font-size-adjusted" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Touch Support:</span>
                    <span id="touch-support" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
            </div>
            
            <!-- Usage Statistics Card -->
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-activity"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
                    Usage Statistics
                </h2>
                <div class="info-item">
                    <span class="info-label">Time on Page:</span>
                    <span id="time-on-page" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
            </div>
            
            <!-- Browser Data Charts -->
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bar-chart-2"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
                    Browser Usage Data
                </h2>
                <div class="chart-container">
                    <div id="browser-chart"></div>
                </div>
            </div>
            
            <!-- Hardware Performance Charts -->
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-cpu"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><rect x="9" y="9" width="6" height="6"></rect><line x1="9" y1="1" x2="9" y2="4"></line><line x1="15" y1="1" x2="15" y2="4"></line><line x1="9" y1="20" x2="9" y2="23"></line><line x1="15" y1="20" x2="15" y2="23"></line><line x1="20" y1="9" x2="23" y2="9"></line><line x1="20" y1="14" x2="23" y2="14"></line><line x1="1" y1="9" x2="4" y2="9"></line><line x1="1" y1="14" x2="4" y2="14"></line></svg>
                    Hardware Performance
                </h2>
                <div class="chart-container">
                    <div id="performance-chart"></div>
                </div>
            </div>
            
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                    Extended Usage Statistics
                </h2>
                <div class="info-item">
                    <span class="info-label">Reading Speed Estimate:</span>
                    <span id="reading-speed" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Timezone & Local Time:</span>
                    <span id="timezone-info" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
                <div class="info-item">
                    <span class="info-label">Mouse Activity:</span>
                    <span id="mouse-activity" class="info-value">
                        <div class="shimmer"></div>
                    </span>
                </div>
            </div>
        </div>
        <div class="action-bar action-bar-bottom">
            <button id="download-pdf-btn" class="action-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                Download PDF Report
            </button>
            <button id="download-text-btn" class="action-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline></svg>
                Download Text Report
            </button>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 InfoScope by D. Weeks. All rights reserved.</p>
    </footer>
    
    <!-- Dark Mode Toggle -->
    <div class="theme-toggle" id="theme-toggle" title="Toggle Dark/Light Mode">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon" id="moon-icon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun" id="sun-icon" style="display: none;"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
    </div>

    <script>
        // Function to load IP info from ipinfo.io API
        async function loadIpInfo() {
            try {
                const response = await fetch('https://ipinfo.io/json');
                if (!response.ok) {
                    throw new Error(`HTTP error: ${response.status}`);
                }
                const data = await response.json();
                
                // Update IP address
                document.getElementById('ip-address').textContent = data.ip || 'Not available';
                
                // Update location
                const locationText = data.city && data.region && data.country 
                    ? `${data.city}, ${data.region}, ${data.country}`
                    : 'Not available';
                document.getElementById('location').textContent = locationText;
                
                // Update hostname
                document.getElementById('hostname').textContent = data.hostname || 'Not available';
                
                // Update ISP
                document.getElementById('isp').textContent = data.org || 'Not available';
            } catch (error) {
                console.error('Error fetching IP information:', error);
                document.getElementById('ip-address').textContent = 'Failed to load';
                document.getElementById('location').textContent = 'Failed to load';
                document.getElementById('hostname').textContent = 'Failed to load';
                document.getElementById('isp').textContent = 'Failed to load';
            }
        }

        // Function to detect operating system
        function detectOS() {
            const userAgent = navigator.userAgent;
            let os = 'Unknown';
            
            if (userAgent.indexOf('Win') !== -1) os = 'Windows';
            else if (userAgent.indexOf('Mac') !== -1) os = 'MacOS';
            else if (userAgent.indexOf('X11') !== -1) os = 'UNIX';
            else if (userAgent.indexOf('Linux') !== -1) os = 'Linux';
            else if (userAgent.indexOf('Android') !== -1) os = 'Android';
            else if (userAgent.indexOf('iPhone') !== -1 || userAgent.indexOf('iPad') !== -1) os = 'iOS';
            
            document.getElementById('os').textContent = os;
        }

        // Function to detect browser
        function detectBrowser() {
            const userAgent = navigator.userAgent;
            let browserName = 'Unknown';
            let version = '';
            
            // Chrome
            if (userAgent.indexOf('Chrome') !== -1 && userAgent.indexOf('Edg') === -1 && userAgent.indexOf('OPR') === -1) {
                browserName = 'Chrome';
                version = userAgent.match(/Chrome\/(\d+\.\d+)/)?.[1] || '';
            }
            // Firefox
            else if (userAgent.indexOf('Firefox') !== -1) {
                browserName = 'Firefox';
                version = userAgent.match(/Firefox\/(\d+\.\d+)/)?.[1] || '';
            }
            // Safari
            else if (userAgent.indexOf('Safari') !== -1 && userAgent.indexOf('Chrome') === -1) {
                browserName = 'Safari';
                version = userAgent.match(/Version\/(\d+\.\d+)/)?.[1] || '';
            }
            // Edge
            else if (userAgent.indexOf('Edg') !== -1) {
                browserName = 'Microsoft Edge';
                version = userAgent.match(/Edg\/(\d+\.\d+)/)?.[1] || '';
            }
            // Internet Explorer
            else if (userAgent.indexOf('MSIE') !== -1 || userAgent.indexOf('Trident/') !== -1) {
                browserName = 'Internet Explorer';
                version = userAgent.match(/MSIE (\d+\.\d+)/)?.[1] || '';
            }
            // Opera
            else if (userAgent.indexOf('OPR') !== -1 || userAgent.indexOf('Opera') !== -1) {
                browserName = 'Opera';
                version = userAgent.match(/OPR\/(\d+\.\d+)/)?.[1] || 
                          userAgent.match(/Opera\/(\d+\.\d+)/)?.[1] || '';
            }
            
            document.getElementById('browser').textContent = version ? `${browserName} ${version}` : browserName;
        }

        // Function to get screen resolution
        function getResolution() {
            document.getElementById('resolution').textContent = `${screen.width} × ${screen.height} pixels`;
        }

        // Function to get browser window size
        function getBrowserSize() {
            document.getElementById('browser-size').textContent = `${window.innerWidth} × ${window.innerHeight} pixels`;
        }

        // Function to get color depth
        function getColorDepth() {
            document.getElementById('color-depth').textContent = `${screen.colorDepth} bits per pixel`;
        }

        // Function to get and increment page views
        function trackPageViews() {
            let pageViews = localStorage.getItem('infoScopePageViews') || 0;
            pageViews = parseInt(pageViews) + 1;
            localStorage.setItem('infoScopePageViews', pageViews);
            document.getElementById('page-views').textContent = pageViews;
        }

        // Function to get supported languages
        function getSupportedLanguages() {
            const languages = navigator.languages || [navigator.language || navigator.userLanguage];
            document.getElementById('languages').textContent = languages.join(', ');
        }

        // Function to check PDF viewer
        function checkPdfViewer() {
            // This is a best-effort determination based on browser
            const userAgent = navigator.userAgent;
            let pdfViewer = 'Browser Default';
            
            if (userAgent.indexOf('Chrome') !== -1) {
                pdfViewer = 'Chrome PDF Viewer';
            } else if (userAgent.indexOf('Firefox') !== -1) {
                pdfViewer = 'Firefox PDF Viewer';
            } else if (userAgent.indexOf('Safari') !== -1) {
                pdfViewer = 'Safari PDF Viewer';
            } else if (userAgent.indexOf('Edg') !== -1) {
                pdfViewer = 'Edge PDF Viewer';
            }
            
            document.getElementById('pdf-viewer').textContent = `${pdfViewer} (Opens in browser)`;
        }

        // Function to list plugins
        function listPlugins() {
            const pluginsContainer = document.getElementById('plugins-container');
            pluginsContainer.innerHTML = '';
            
            if (navigator.plugins && navigator.plugins.length > 0) {
                for (let i = 0; i < navigator.plugins.length; i++) {
                    const plugin = navigator.plugins[i];
                    const pluginEl = document.createElement('div');
                    pluginEl.classList.add('list-item');
                    pluginEl.textContent = plugin.name;
                    pluginsContainer.appendChild(pluginEl);
                }
            } else {
                const noPluginsEl = document.createElement('div');
                noPluginsEl.textContent = 'No plugins detected or plugin information is restricted';
                pluginsContainer.appendChild(noPluginsEl);
            }
        }

        // Hardware Information Functions
        
        // Function to get battery status
        async function getBatteryStatus() {
            try {
                if ('getBattery' in navigator) {
                    const battery = await navigator.getBattery();
                    const level = Math.round(battery.level * 100);
                    const charging = battery.charging ? 'Charging' : 'Not charging';
                    const remainingTime = battery.charging ? 
                        (battery.chargingTime === Infinity ? 'Calculating...' : formatTime(battery.chargingTime)) :
                        (battery.dischargingTime === Infinity ? 'Calculating...' : formatTime(battery.dischargingTime));
                    
                    const status = `${level}% (${charging}, ${remainingTime} remaining)`;
                    document.getElementById('battery-status').textContent = status;
                    
                    // Add event listeners for battery changes
                    battery.addEventListener('levelchange', () => {
                        getBatteryStatus();
                    });
                    battery.addEventListener('chargingchange', () => {
                        getBatteryStatus();
                    });
                } else {
                    document.getElementById('battery-status').textContent = 'API not supported';
                }
            } catch (error) {
                document.getElementById('battery-status').textContent = 'Not available';
            }
        }
        
        // Function to get device memory
        function getDeviceMemory() {
            if ('deviceMemory' in navigator) {
                document.getElementById('device-memory').textContent = `${navigator.deviceMemory} GB`;
            } else {
                document.getElementById('device-memory').textContent = 'API not supported';
            }
        }
        
        // Function to get CPU cores
        function getCPUCores() {
            if ('hardwareConcurrency' in navigator) {
                document.getElementById('cpu-cores').textContent = `${navigator.hardwareConcurrency} logical cores`;
            } else {
                document.getElementById('cpu-cores').textContent = 'API not supported';
            }
        }
        
        // Function to get connection type
        function getConnectionType() {
            if ('connection' in navigator) {
                const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
                if (connection) {
                    let connectionInfo = [];
                    
                    if (connection.type) {
                        connectionInfo.push(`Type: ${connection.type}`);
                    }
                    
                    if (connection.effectiveType) {
                        connectionInfo.push(`Effective Type: ${connection.effectiveType}`);
                    }
                    
                    if (connection.downlink) {
                        connectionInfo.push(`Downlink: ${connection.downlink} Mbps`);
                    }
                    
                    if (connection.rtt) {
                        connectionInfo.push(`Round-Trip Time: ${connection.rtt} ms`);
                    }
                    
                    if (connection.saveData) {
                        connectionInfo.push('Data Saver: Enabled');
                    }
                    
                    document.getElementById('connection-type').textContent = connectionInfo.length ? connectionInfo.join(', ') : 'Connected';
                    
                    // Add event listener for connection changes
                    connection.addEventListener('change', getConnectionType);
                } else {
                    document.getElementById('connection-type').textContent = 'Connected (details not available)';
                }
            } else {
                document.getElementById('connection-type').textContent = 'API not supported';
            }
        }
        
        // Function to detect detailed network information
        function detectNetworkInfo() {
            const networkTypeEl = document.getElementById('network-type');
            const connectionSpeedEl = document.getElementById('connection-speed');
            const networkLatencyEl = document.getElementById('network-latency');
            const saveDataEl = document.getElementById('save-data');
            
            if ('connection' in navigator) {
                const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
                
                if (connection) {
                    // Network Type (WiFi, cellular, ethernet, etc.)
                    const type = connection.type || 'unknown';
                    const effectiveType = connection.effectiveType || '';
                    let typeDisplay = 'Unknown';
                    
                    if (type !== 'unknown') {
                        typeDisplay = type.charAt(0).toUpperCase() + type.slice(1);
                    } else if (effectiveType) {
                        typeDisplay = `Unknown (effective: ${effectiveType})`;
                    }
                    
                    networkTypeEl.textContent = typeDisplay;
                    
                    // Connection Speed
                    if (connection.downlink) {
                        connectionSpeedEl.textContent = `${connection.downlink} Mbps`;
                    } else {
                        connectionSpeedEl.textContent = 'Not available';
                    }
                    
                    // Estimated Latency
                    if (connection.rtt) {
                        networkLatencyEl.textContent = `${connection.rtt} ms`;
                    } else {
                        networkLatencyEl.textContent = 'Not available';
                    }
                    
                    // Save-Data Mode
                    if ('saveData' in connection) {
                        saveDataEl.textContent = connection.saveData ? 'Enabled' : 'Disabled';
                    } else {
                        saveDataEl.textContent = 'Not available';
                    }
                    
                    // Listen for connection changes
                    try {
                        connection.addEventListener('change', detectNetworkInfo);
                    } catch (e) {
                        console.log("Could not add network change listener:", e);
                    }
                } else {
                    // Connection object not available
                    networkTypeEl.textContent = 'Not available';
                    connectionSpeedEl.textContent = 'Not available';
                    networkLatencyEl.textContent = 'Not available';
                    saveDataEl.textContent = 'Not available';
                }
            } else {
                // Network API not supported
                networkTypeEl.textContent = 'Not supported';
                connectionSpeedEl.textContent = 'Not supported';
                networkLatencyEl.textContent = 'Not supported';
                saveDataEl.textContent = 'Not supported';
            }
        }
        
        // Browser Capabilities Functions
        
        // Function to check WebGL support
        function checkWebGLSupport() {
            const canvas = document.createElement('canvas');
            let webglContext;
            let support = 'Not supported';
            
            try {
                webglContext = canvas.getContext('webgl2');
                if (webglContext) {
                    support = 'WebGL 2.0';
                } else {
                    webglContext = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                    if (webglContext) {
                        support = 'WebGL 1.0';
                    }
                }
            } catch (e) {
                support = 'Error detecting';
            }
            
            document.getElementById('webgl-support').textContent = support;
        }
        
        // Function to get graphics card info
        function getGraphicsCardInfo() {
            const canvas = document.createElement('canvas');
            let gl;
            let renderer = 'Not available';
            
            try {
                gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (gl) {
                    const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                    if (debugInfo) {
                        renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
                    }
                }
            } catch (e) {
                renderer = 'Error detecting';
            }
            
            document.getElementById('graphics-card').textContent = renderer;
        }
        
        // Function to check media support
        function checkMediaSupport() {
            const audio = document.createElement('audio');
            const video = document.createElement('video');
            
            const audioTypes = {
                mp3: 'audio/mpeg',
                ogg: 'audio/ogg',
                wav: 'audio/wav',
                aac: 'audio/aac'
            };
            
            const videoTypes = {
                mp4: 'video/mp4',
                webm: 'video/webm',
                ogv: 'video/ogg'
            };
            
            const supportedAudio = Object.keys(audioTypes).filter(type => {
                return !!audio.canPlayType(audioTypes[type]);
            });
            
            const supportedVideo = Object.keys(videoTypes).filter(type => {
                return !!video.canPlayType(videoTypes[type]);
            });
            
            const supportText = [
                `Audio: ${supportedAudio.join(', ') || 'None'}`,
                `Video: ${supportedVideo.join(', ') || 'None'}`
            ].join(', ');
            
            document.getElementById('media-support').textContent = supportText;
        }
        
        // Function to check WebRTC support
        function checkWebRTCSupport() {
            let rtcSupport = [];
            
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                rtcSupport.push('getUserMedia');
            }
            
            if (window.RTCPeerConnection) {
                rtcSupport.push('RTCPeerConnection');
            }
            
            if (window.RTCDataChannel) {
                rtcSupport.push('RTCDataChannel');
            }
            
            document.getElementById('webrtc-support').textContent = rtcSupport.length ? 
                `Supported (${rtcSupport.join(', ')})` : 'Not supported';
        }
        
        // Privacy & Security Functions
        
        // Function to check Do Not Track status
        function checkDoNotTrack() {
            const dnt = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
            let status = 'Not specified';
            
            if (dnt === '1' || dnt === 'yes') {
                status = 'Enabled';
            } else if (dnt === '0' || dnt === 'no') {
                status = 'Disabled';
            }
            
            document.getElementById('do-not-track').textContent = status;
        }
        
        // Function to detect ad blockers
        function detectAdBlocker() {
            // Create a bait element that ad blockers might hide
            const bait = document.createElement('div');
            bait.className = 'ad-placement ad-unit textads banner-ads adsbox';
            bait.style.position = 'absolute';
            bait.style.left = '-999px';
            bait.style.top = '-999px';
            bait.style.height = '1px';
            bait.style.width = '1px';
            document.body.appendChild(bait);
            
            setTimeout(() => {
                let isBlocked = false;
                
                // Check if ad blocker is hiding the bait element
                if (bait.offsetHeight === 0 || 
                    bait.offsetWidth === 0 || 
                    bait.clientHeight === 0 || 
                    bait.clientWidth === 0) {
                    isBlocked = true;
                }
                
                // Remove the bait element
                document.body.removeChild(bait);
                
                document.getElementById('ad-blocker').textContent = isBlocked ? 
                    'Detected (Ad blocker active)' : 'Not detected';
            }, 100);
        }
        
        // Function to detect incognito/private mode
        function detectIncognitoMode() {
            // Try to use storage APIs which might be limited in private mode
            const fs = window.RequestFileSystem || window.webkitRequestFileSystem;
            
            if (!fs) {
                testIndexedDB();
                return;
            }
            
            fs(window.TEMPORARY, 100, 
                () => {
                    document.getElementById('incognito-mode').textContent = 'Not detected';
                }, 
                () => {
                    document.getElementById('incognito-mode').textContent = 'Detected (Private Browsing)';
                }
            );
            
            function testIndexedDB() {
                try {
                    const db = window.indexedDB.open('test');
                    db.onerror = () => {
                        document.getElementById('incognito-mode').textContent = 'Detected (Private Browsing)';
                    };
                    db.onsuccess = () => {
                        document.getElementById('incognito-mode').textContent = 'Not detected';
                    };
                } catch (e) {
                    document.getElementById('incognito-mode').textContent = 'Detection method not supported';
                }
            }
        }
        
        // Function to check if cookies are enabled
        function checkCookiesEnabled() {
            const cookiesEnabled = navigator.cookieEnabled;
            document.getElementById('cookies-enabled').textContent = cookiesEnabled ? 'Yes' : 'No';
        }
        
        // Function to check browser cache storage
        async function checkCacheStorage() {
            try {
                if ('caches' in window) {
                    // Try to get all cache names
                    const cacheNames = await caches.keys();
                    const cacheCount = cacheNames.length;
                    
                    // Set a test cache item with timestamp to check if cache is working
                    const cacheName = 'infoscope-test-cache';
                    const cache = await caches.open(cacheName);
                    
                    // Store a timestamp to check when cache was last reset
                    const now = new Date();
                    const testResponse = new Response(JSON.stringify({
                        timestamp: now.getTime(),
                        date: now.toISOString()
                    }));
                    
                    await cache.put('/cache-test', testResponse.clone());
                    
                    // Try to retrieve previous cache tests to estimate when cache was cleared
                    let cacheStatus = `Active (${cacheCount} caches detected)`;
                    
                    // Check if we have a stored timestamp in localStorage about when we last saw the cache
                    const lastKnownCacheTime = localStorage.getItem('infoscope-cache-timestamp');
                    
                    if (lastKnownCacheTime) {
                        const lastDate = new Date(parseInt(lastKnownCacheTime));
                        const timeDiff = now.getTime() - lastDate.getTime();
                        
                        // If cache was working before, estimate if it was cleared
                        try {
                            const cachedResponse = await cache.match('/cache-previous-test');
                            
                            if (cachedResponse) {
                                const cachedData = await cachedResponse.json();
                                const cachedTimestamp = new Date(cachedData.date);
                                
                                // Compare with our last localStorage timestamp
                                if (cachedTimestamp.getTime() < lastDate.getTime() - 1000) {
                                    // Cache item is older than our localStorage record, suggesting the cache hasn't been cleared
                                    const daysSinceVisit = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
                                    cacheStatus += `, Last cleared: > ${daysSinceVisit} days ago`;
                                }
                            } else {
                                // We couldn't find our previous test item, suggesting cache was recently cleared
                                cacheStatus += ', Cache was recently cleared';
                            }
                        } catch (e) {
                            // Error accessing previous cache test
                        }
                    }
                    
                    // Store a separate test item that we'll check next time
                    await cache.put('/cache-previous-test', testResponse);
                    
                    // Update localStorage with current timestamp
                    localStorage.setItem('infoscope-cache-timestamp', now.getTime().toString());
                    
                    document.getElementById('cache-storage').textContent = cacheStatus;
                } else {
                    document.getElementById('cache-storage').textContent = 'API not supported';
                }
            } catch (error) {
                document.getElementById('cache-storage').textContent = 'Error detecting cache status';
            }
        }
        
        // Function to check local storage size
        function checkLocalStorageSize() {
            try {
                // Check if localStorage is available
                if (window.localStorage) {
                    // Estimate current localStorage usage
                    let totalSize = 0;
                    
                    for (let key in localStorage) {
                        if (localStorage.hasOwnProperty(key)) {
                            totalSize += localStorage[key].length + key.length;
                        }
                    }
                    
                    // Convert to KB
                    const sizeInKB = (totalSize / 1024).toFixed(2);
                    
                    // Estimate time since local storage was last cleared
                    let clearEstimate = '';
                    
                    // Check if we have a marker we can use
                    if (!localStorage.getItem('infoscope-localstorage-marker')) {
                        // First visit or localStorage was cleared
                        localStorage.setItem('infoscope-localstorage-marker', Date.now().toString());
                        clearEstimate = 'Recently cleared or first visit';
                    } else {
                        const marker = parseInt(localStorage.getItem('infoscope-localstorage-marker'));
                        const now = Date.now();
                        const daysSinceMarker = Math.floor((now - marker) / (1000 * 60 * 60 * 24));
                        
                        clearEstimate = `Not cleared for at least ${daysSinceMarker} days`;
                    }
                    
                    // Display the results
                    document.getElementById('local-storage-size').textContent = 
                        `${sizeInKB} KB used (${clearEstimate})`;
                } else {
                    document.getElementById('local-storage-size').textContent = 'Not supported';
                }
            } catch (e) {
                // This can happen if localStorage is disabled or in private browsing mode
                document.getElementById('local-storage-size').textContent = 'Access restricted or disabled';
            }
        }
        
        // Function to check IndexedDB support
        function checkIndexedDBSupport() {
            const indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;
            
            if (indexedDB) {
                // Try to open a test database to check if it's really available
                try {
                    const request = indexedDB.open('infoscope-test-db', 1);
                    let dbStatus = 'Supported';
                    
                    request.onerror = function() {
                        // IndexedDB is technically supported but not available (e.g., private browsing)
                        document.getElementById('indexeddb-support').textContent = 'Supported but restricted';
                    };
                    
                    request.onsuccess = function() {
                        // Successfully opened the database
                        const db = request.result;
                        dbStatus += ' and accessible';
                        
                        // Check for existing object stores to estimate usage
                        if (db.objectStoreNames.length > 0) {
                            dbStatus += ` (${db.objectStoreNames.length} stores detected)`;
                        }
                        
                        document.getElementById('indexeddb-support').textContent = dbStatus;
                        
                        // Close the database
                        db.close();
                    };
                } catch (e) {
                    document.getElementById('indexeddb-support').textContent = 'Error accessing IndexedDB';
                }
            } else {
                document.getElementById('indexeddb-support').textContent = 'Not supported';
            }
        }
        
        // Accessibility & Preferences Functions
        
        // Function to detect preferred color scheme
        function detectColorScheme() {
            if (window.matchMedia) {
                const darkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
                const lightMode = window.matchMedia('(prefers-color-scheme: light)').matches;
                
                if (darkMode) {
                    document.getElementById('color-scheme').textContent = 'Dark mode preferred';
                } else if (lightMode) {
                    document.getElementById('color-scheme').textContent = 'Light mode preferred';
                } else {
                    document.getElementById('color-scheme').textContent = 'No preference detected';
                }
                
                // Add listener for scheme changes
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', detectColorScheme);
            } else {
                document.getElementById('color-scheme').textContent = 'Detection not supported';
            }
        }
        
        // Function to detect reduced motion preference
        function detectReducedMotion() {
            if (window.matchMedia) {
                const reducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
                document.getElementById('reduced-motion').textContent = reducedMotion ? 
                    'Enabled (animations reduced)' : 'Not enabled';
                    
                // Add listener for preference changes
                window.matchMedia('(prefers-reduced-motion: reduce)').addEventListener('change', detectReducedMotion);
            } else {
                document.getElementById('reduced-motion').textContent = 'Detection not supported';
            }
        }
        
        // Function to detect if font size has been adjusted
        function detectFontSizeAdjusted() {
            // Try to detect by comparing a test element's computed size with its expected size
            const testElement = document.createElement('div');
            testElement.style.fontSize = '1rem';
            testElement.style.position = 'absolute';
            testElement.style.visibility = 'hidden';
            testElement.textContent = 'M'; // Single character for measurement
            document.body.appendChild(testElement);
            
            // Get the computed font size
            const computedSize = parseFloat(window.getComputedStyle(testElement).fontSize);
            document.body.removeChild(testElement);
            
            // Check if the base font size is significantly different from the browser's default (16px)
            // Allow for minor differences due to rounding and browser implementation differences
            const defaultSize = 16;
            const sizeRatio = computedSize / defaultSize;
            const adjusted = Math.abs(sizeRatio - 1) > 0.1; // 10% threshold for detection
            
            document.getElementById('font-size-adjusted').textContent = adjusted ? 
                `Yes (${Math.round(sizeRatio * 100)}% of default)` : 'No (browser default)';
        }
        
        // Function to detect font size adjustments
        function detectFontSizeAdjustment() {
            // 16px is typically the default font size in browsers
            const defaultSize = 16;
            const currentSize = parseFloat(window.getComputedStyle(document.documentElement).fontSize);
            const adjustment = Math.round((currentSize / defaultSize) * 100);
            
            let status = 'Default size';
            if (adjustment > 100) {
                status = `Increased (${adjustment}% of normal)`;
            } else if (adjustment < 100) {
                status = `Decreased (${adjustment}% of normal)`;
            }
            
            document.getElementById('font-size-adjusted').textContent = status;
        }
        
        // Function to detect touch support
        function detectTouchSupport() {
            const hasTouchSupport = 'ontouchstart' in window || 
                                  navigator.maxTouchPoints > 0 || 
                                  navigator.msMaxTouchPoints > 0;
                                  
            let touchInfo = hasTouchSupport ? 'Supported' : 'Not supported';
            
            if (hasTouchSupport && navigator.maxTouchPoints) {
                touchInfo += ` (${navigator.maxTouchPoints} touch points)`;
            }
            
            document.getElementById('touch-support').textContent = touchInfo;
        }
        
        // Usage Statistics Functions
        
        // Variables for usage statistics
        let pageLoadTime = new Date();
        let mouseMovements = 0;
        let mouseClicks = 0;
        let keyPresses = 0;
        let scrollEvents = 0;
        
        // Function to update time on page
        function updateTimeOnPage() {
            const currentTime = new Date();
            const timeSpent = Math.floor((currentTime - pageLoadTime) / 1000);
            document.getElementById('time-on-page').textContent = formatTime(timeSpent);
            
            // Update reading speed estimate
            updateReadingSpeedEstimate(timeSpent);
            
            // Schedule next update
            setTimeout(updateTimeOnPage, 1000);
        }
        
        // Function to estimate reading speed based on content and time spent
        function updateReadingSpeedEstimate(timeSpent) {
            if (timeSpent < 5) return; // Too early to estimate
            
            // Count approximate number of words in the visible content
            const textContent = document.body.innerText;
            const wordCount = textContent.split(/\s+/).length;
            
            // Estimate words per minute
            const minutes = timeSpent / 60;
            const wpm = Math.round(wordCount / minutes);
            
            // Get reading level based on average WPM ranges
            let readingLevel = 'Average';
            if (wpm > 250) readingLevel = 'Fast';
            if (wpm > 400) readingLevel = 'Very fast';
            if (wpm < 150) readingLevel = 'Relaxed';
            
            document.getElementById('reading-speed').textContent = `~${wpm} words per minute (${readingLevel} reader)`;
        }
        
        // Function to get timezone information
        function getTimezoneInfo() {
            try {
                const date = new Date();
                const timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone || "Unknown";
                const localTime = date.toLocaleTimeString();
                const offset = -date.getTimezoneOffset() / 60;
                const offsetStr = offset >= 0 ? `+${offset}` : `${offset}`;
                
                document.getElementById('timezone-info').textContent = 
                    `${timeZone} (UTC${offsetStr}), Current time: ${localTime}`;
                    
                // Update timezone info every minute
                setTimeout(getTimezoneInfo, 60000);
            } catch (error) {
                document.getElementById('timezone-info').textContent = 
                    "Unable to detect timezone information";
                console.error("Error getting timezone info:", error);
            }
        }
        
        // Function to track mouse activity
        function trackMouseActivity() {
            try {
                // Initialize the mouse activity display first
                updateMouseActivity();
                
                // Throttle mouse movement tracking to avoid performance issues
                let lastMouseUpdate = 0;
                
                // Track mouse movements with throttling
                document.addEventListener('mousemove', (e) => {
                    const now = Date.now();
                    if (now - lastMouseUpdate > 100) { // Only update every 100ms
                        mouseMovements++;
                        lastMouseUpdate = now;
                        updateMouseActivity();
                    }
                });
                
                // Track mouse clicks
                document.addEventListener('click', () => {
                    mouseClicks++;
                    updateMouseActivity();
                });
                
                // Track key presses
                document.addEventListener('keydown', () => {
                    keyPresses++;
                    updateMouseActivity();
                });
                
                // Track scroll events with throttling
                let lastScrollUpdate = 0;
                document.addEventListener('scroll', () => {
                    const now = Date.now();
                    if (now - lastScrollUpdate > 100) { // Only update every 100ms
                        scrollEvents++;
                        lastScrollUpdate = now;
                        updateMouseActivity();
                    }
                });
                
                console.log("Mouse activity tracking initialized");
            } catch (error) {
                console.error("Error setting up mouse activity tracking:", error);
                document.getElementById('mouse-activity').textContent = "Tracking unavailable";
            }
        }
        
        // Function to update mouse activity display
        function updateMouseActivity() {
            try {
                document.getElementById('mouse-activity').textContent = 
                    `${mouseMovements} movements, ${mouseClicks} clicks, ${keyPresses} key presses, ${scrollEvents} scrolls`;
            } catch (error) {
                console.error("Error updating mouse activity display:", error);
            }
        }
        
        // Utility function to format time in seconds to a readable string
        function formatTime(seconds) {
            if (typeof seconds !== 'number' || seconds < 0) {
                return 'Unknown';
            }
            
            if (seconds < 60) {
                return `${seconds} seconds`;
            }
            
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            
            if (minutes < 60) {
                return `${minutes} minutes, ${remainingSeconds} seconds`;
            }
            
            const hours = Math.floor(minutes / 60);
            const remainingMinutes = minutes % 60;
            
            return `${hours} hours, ${remainingMinutes} minutes`;
        }
        
        // Function to initialize all information
        function initializeInfo() {
            // Original info
            loadIpInfo();
            detectOS();
            detectBrowser();
            getResolution();
            getBrowserSize();
            getColorDepth();
            trackPageViews();
            getSupportedLanguages();
            checkPdfViewer();
            listPlugins();
            
            // Hardware information
            getBatteryStatus();
            getDeviceMemory();
            getCPUCores();
            getConnectionType();
            detectNetworkInfo(); // New detailed network info
            
            // Browser capabilities
            checkWebGLSupport();
            getGraphicsCardInfo();
            checkMediaSupport();
            checkWebRTCSupport();
            
            // Privacy & security
            checkDoNotTrack();
            detectAdBlocker();
            detectIncognitoMode();
            checkCookiesEnabled();
            checkCacheStorage();        // New: Check cache storage
            checkLocalStorageSize();    // New: Check local storage size
            checkIndexedDBSupport();    // New: Check IndexedDB support
            
            // Accessibility & preferences
            detectColorScheme();
            detectReducedMotion();
            detectFontSizeAdjustment();
            detectTouchSupport();
            
            // Usage statistics
            getTimezoneInfo();
            trackMouseActivity();
            updateTimeOnPage();
        }

        // Function to generate PDF report
        function generatePDF() {
            const { jsPDF } = window.jspdf;
            // Create PDF with better default font
            const doc = new jsPDF({
                unit: 'mm',
                orientation: 'portrait',
                lineHeight: 1.5
            });
            
            // Define color scheme to match website
            const primaryColor = [74, 109, 167]; // #4a6da7
            const secondaryColor = [48, 72, 120]; // #304878
            const backgroundColor = [249, 250, 251]; // #f9fafb
            const textColor = [51, 51, 51]; // #333333
            const textLightColor = [102, 102, 102]; // #666666
            const borderColor = [229, 231, 235]; // #e5e7eb
            const accentColor = [138, 180, 248]; // #8ab4f8
            
            // Add header background
            doc.setFillColor(primaryColor[0], primaryColor[1], primaryColor[2]);
            doc.rect(0, 0, 210, 40, 'F');
            
            // Create header gradient effect (multiple rectangles with decreasing opacity)
            for (let i = 0; i < 5; i++) {
                const opacity = 0.2 - (i * 0.04);
                doc.setFillColor(secondaryColor[0], secondaryColor[1], secondaryColor[2]);
                doc.setGState(new doc.GState({ opacity: opacity }));
                doc.rect(0, 0, 210 - (i * 40), 40, 'F');
            }
            
            // Reset opacity
            doc.setGState(new doc.GState({ opacity: 1 }));
            
            // Add title
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(28);
            doc.setTextColor(255, 255, 255); // White color for text on header
            doc.text('InfoScope-DW', 105, 17, { align: 'center' });
            
            // Add subtitle
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(13);
            doc.setTextColor(255, 255, 255, 0.95); // White with slight transparency
            doc.text('Comprehensive System & Browser Information Report', 105, 26, { align: 'center' });
            
            // Add date and time
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255, 0.9);
            const currentDate = new Date().toLocaleString();
            doc.text(`Generated on: ${currentDate}`, 105, 34, { align: 'center' });
            
            // Set background color for the content area
            doc.setFillColor(backgroundColor[0], backgroundColor[1], backgroundColor[2]);
            doc.rect(0, 40, 210, 257, 'F');
            
            // Set content text properties
            doc.setTextColor(textColor[0], textColor[1], textColor[2]);
            doc.setFontSize(14);
            
            // Function to add a section with card-like appearance
            function addSection(title, y, data) {
                // Draw card background
                doc.setFillColor(255, 255, 255); // White background for card
                doc.setDrawColor(borderColor[0], borderColor[1], borderColor[2]);
                doc.roundedRect(15, y, 180, data.length * 10 + 25, 3, 3, 'FD');
                
                // Add section title with primary color
                doc.setFont('helvetica', 'bold');
                doc.setFontSize(14);
                doc.setTextColor(primaryColor[0], primaryColor[1], primaryColor[2]);
                doc.text(title, 25, y + 15);
                
                // Add content
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(11);
                doc.setTextColor(textColor[0], textColor[1], textColor[2]);
                
                data.forEach((item, index) => {
                    const label = item.label;
                    const value = item.value;
                    
                    // Add label with lighter color
                    doc.setTextColor(textLightColor[0], textLightColor[1], textLightColor[2]);
                    doc.setFont('helvetica', 'bold');
                    doc.text(`${label}:`, 30, y + 30 + (index * 10));
                    
                    // Add value
                    doc.setTextColor(textColor[0], textColor[1], textColor[2]);
                    doc.setFont('helvetica', 'normal');
                    doc.text(value, 90, y + 30 + (index * 10));
                });
                
                return y + data.length * 10 + 30; // Return the next Y position
            }
            
            // Gather all data
            const ipAddress = document.getElementById('ip-address').textContent;
            const location = document.getElementById('location').textContent;
            const hostname = document.getElementById('hostname').textContent;
            const isp = document.getElementById('isp').textContent;
            
            const os = document.getElementById('os').textContent;
            const browser = document.getElementById('browser').textContent;
            const resolution = document.getElementById('resolution').textContent;
            const browserSize = document.getElementById('browser-size').textContent;
            const colorDepth = document.getElementById('color-depth').textContent;
            const pageViews = document.getElementById('page-views').textContent;
            
            const languages = document.getElementById('languages').textContent;
            const pdfViewer = document.getElementById('pdf-viewer').textContent;
            
            // Add Location Information section
            let nextY = addSection('Location Information', 50, [
                { label: 'IP Address', value: ipAddress },
                { label: 'Location', value: location },
                { label: 'Hostname', value: hostname },
                { label: 'ISP', value: isp }
            ]);
            
            // Add System Information section
            nextY = addSection('System Information', nextY + 10, [
                { label: 'Operating System', value: os },
                { label: 'Browser', value: browser },
                { label: 'Screen Resolution', value: resolution },
                { label: 'Browser Size', value: browserSize },
                { label: 'Color Depth', value: colorDepth },
                { label: 'Page Views', value: pageViews }
            ]);
            
            // Add Languages & PDF section
            nextY = addSection('Languages & PDF', nextY + 10, [
                { label: 'Languages Supported', value: languages },
                { label: 'Default PDF Viewer', value: pdfViewer }
            ]);
            
            // Hardware Information
            const batteryStatus = document.getElementById('battery-status').textContent;
            const deviceMemory = document.getElementById('device-memory').textContent;
            const cpuCores = document.getElementById('cpu-cores').textContent;
            const connectionType = document.getElementById('connection-type').textContent;
            
            nextY = addSection('Hardware Information', nextY + 10, [
                { label: 'Battery Status', value: batteryStatus },
                { label: 'Device Memory', value: deviceMemory },
                { label: 'CPU Cores', value: cpuCores },
                { label: 'Connection Type', value: connectionType }
            ]);
            
            // Browser Capabilities
            const webglSupport = document.getElementById('webgl-support').textContent;
            const graphicsCard = document.getElementById('graphics-card').textContent;
            const mediaSupport = document.getElementById('media-support').textContent;
            const webrtcSupport = document.getElementById('webrtc-support').textContent;
            
            nextY = addSection('Browser Capabilities', nextY + 10, [
                { label: 'WebGL Support', value: webglSupport },
                { label: 'Graphics Card', value: graphicsCard },
                { label: 'Media Support', value: mediaSupport },
                { label: 'WebRTC Support', value: webrtcSupport }
            ]);
            
            // Privacy & Security
            const doNotTrack = document.getElementById('do-not-track').textContent;
            const adBlocker = document.getElementById('ad-blocker').textContent;
            const incognitoMode = document.getElementById('incognito-mode').textContent;
            const cookiesEnabled = document.getElementById('cookies-enabled').textContent;
            const cacheStorage = document.getElementById('cache-storage').textContent;
            const localStorageSize = document.getElementById('local-storage-size').textContent;
            const indexedDBSupport = document.getElementById('indexeddb-support').textContent;
            
            // If we still have space on this page
            if (nextY < 200) {
                nextY = addSection('Privacy & Security', nextY + 10, [
                    { label: 'Do Not Track', value: doNotTrack },
                    { label: 'Ad Blocker', value: adBlocker },
                    { label: 'Incognito Mode', value: incognitoMode },
                    { label: 'Cookies Enabled', value: cookiesEnabled },
                    { label: 'Cache Storage', value: cacheStorage },
                    { label: 'Local Storage', value: localStorageSize },
                    { label: 'IndexedDB', value: indexedDBSupport }
                ]);
            } else {
                // Add a new page
                doc.addPage();
                doc.setFillColor(backgroundColor[0], backgroundColor[1], backgroundColor[2]);
                doc.rect(0, 0, 210, 297, 'F');
                nextY = 10;
                
                nextY = addSection('Privacy & Security', nextY + 10, [
                    { label: 'Do Not Track', value: doNotTrack },
                    { label: 'Ad Blocker', value: adBlocker },
                    { label: 'Incognito Mode', value: incognitoMode },
                    { label: 'Cookies Enabled', value: cookiesEnabled },
                    { label: 'Cache Storage', value: cacheStorage },
                    { label: 'Local Storage', value: localStorageSize },
                    { label: 'IndexedDB', value: indexedDBSupport }
                ]);
            }
            
            // Accessibility & Preferences
            const colorScheme = document.getElementById('color-scheme').textContent;
            const reducedMotion = document.getElementById('reduced-motion').textContent;
            const fontSizeAdjusted = document.getElementById('font-size-adjusted').textContent;
            const touchSupport = document.getElementById('touch-support').textContent;
            
            nextY = addSection('Accessibility & Preferences', nextY + 10, [
                { label: 'Color Scheme', value: colorScheme },
                { label: 'Reduced Motion', value: reducedMotion },
                { label: 'Font Size Adjusted', value: fontSizeAdjusted },
                { label: 'Touch Support', value: touchSupport }
            ]);
            
            // Usage Statistics
            const timeOnPage = document.getElementById('time-on-page').textContent;
            const readingSpeed = document.getElementById('reading-speed').textContent;
            const timezoneInfo = document.getElementById('timezone-info').textContent;
            const mouseActivity = document.getElementById('mouse-activity').textContent;
            
            addSection('Usage Statistics', nextY + 10, [
                { label: 'Time on Page', value: timeOnPage },
                { label: 'Reading Speed', value: readingSpeed },
                { label: 'Timezone & Time', value: timezoneInfo },
                { label: 'Mouse Activity', value: mouseActivity }
            ]);
            
            // Add footer
            doc.setDrawColor(borderColor[0], borderColor[1], borderColor[2]);
            doc.setLineWidth(0.5);
            doc.line(15, 275, 195, 275);
            
            doc.setFont('helvetica', 'italic');
            doc.setFontSize(9);
            doc.setTextColor(textLightColor[0], textLightColor[1], textLightColor[2]);
            doc.text('Generated by InfoScope-DW • Your comprehensive browser and system information', 105, 282, { align: 'center' });
            doc.text('© 2025 InfoScope-DW. All rights reserved.', 105, 288, { align: 'center' });
            
            // Save the PDF
            doc.save('InfoScope-DW-System-Report.pdf');
        }

        // Function to generate plain text report
        function generateTextReport() {
            // Create the text report
            let textReport = "===============================================\n";
            textReport += "              INFOSCOPE-DW REPORT                 \n";
            textReport += "===============================================\n\n";
            textReport += `Generated on: ${new Date().toLocaleString()}\n\n`;
            
            // Location Information
            textReport += "LOCATION INFORMATION\n";
            textReport += "-----------------------------------------------\n";
            textReport += `IP Address:    ${document.getElementById('ip-address').textContent}\n`;
            textReport += `Location:      ${document.getElementById('location').textContent}\n`;
            textReport += `Hostname:      ${document.getElementById('hostname').textContent}\n`;
            textReport += `ISP:           ${document.getElementById('isp').textContent}\n\n`;
            
            // System Information
            textReport += "SYSTEM INFORMATION\n";
            textReport += "-----------------------------------------------\n";
            textReport += `Operating System:   ${document.getElementById('os').textContent}\n`;
            textReport += `Browser:            ${document.getElementById('browser').textContent}\n`;
            textReport += `Screen Resolution:  ${document.getElementById('resolution').textContent}\n`;
            textReport += `Browser Size:       ${document.getElementById('browser-size').textContent}\n`;
            textReport += `Color Depth:        ${document.getElementById('color-depth').textContent}\n`;
            textReport += `Page Views:         ${document.getElementById('page-views').textContent}\n\n`;
            
            // Languages & PDF
            textReport += "LANGUAGES & PDF\n";
            textReport += "-----------------------------------------------\n";
            textReport += `Languages Supported: ${document.getElementById('languages').textContent}\n`;
            textReport += `Default PDF Viewer:  ${document.getElementById('pdf-viewer').textContent}\n\n`;
            
            // Hardware Information
            textReport += "HARDWARE INFORMATION\n";
            textReport += "-----------------------------------------------\n";
            textReport += `Battery Status:    ${document.getElementById('battery-status').textContent}\n`;
            textReport += `Device Memory:     ${document.getElementById('device-memory').textContent}\n`;
            textReport += `CPU Cores:         ${document.getElementById('cpu-cores').textContent}\n`;
            textReport += `Connection Type:   ${document.getElementById('connection-type').textContent}\n\n`;
            
            // Browser Capabilities
            textReport += "BROWSER CAPABILITIES\n";
            textReport += "-----------------------------------------------\n";
            textReport += `WebGL Support:     ${document.getElementById('webgl-support').textContent}\n`;
            textReport += `Graphics Card:     ${document.getElementById('graphics-card').textContent}\n`;
            textReport += `Media Support:     ${document.getElementById('media-support').textContent}\n`;
            textReport += `WebRTC Support:    ${document.getElementById('webrtc-support').textContent}\n\n`;
            
            // Privacy & Security
            textReport += "PRIVACY & SECURITY\n";
            textReport += "-----------------------------------------------\n";
            textReport += `Do Not Track:      ${document.getElementById('do-not-track').textContent}\n`;
            textReport += `Ad Blocker:        ${document.getElementById('ad-blocker').textContent}\n`;
            textReport += `Incognito Mode:    ${document.getElementById('incognito-mode').textContent}\n`;
            textReport += `Cookies Enabled:   ${document.getElementById('cookies-enabled').textContent}\n`;
            textReport += `Cache Storage:     ${document.getElementById('cache-storage').textContent}\n`;
            textReport += `Local Storage:     ${document.getElementById('local-storage-size').textContent}\n`;
            textReport += `IndexedDB:         ${document.getElementById('indexeddb-support').textContent}\n\n`;
            
            // Accessibility & Preferences
            textReport += "ACCESSIBILITY & PREFERENCES\n";
            textReport += "-----------------------------------------------\n";
            textReport += `Color Scheme:      ${document.getElementById('color-scheme').textContent}\n`;
            textReport += `Reduced Motion:    ${document.getElementById('reduced-motion').textContent}\n`;
            textReport += `Font Size Adjusted: ${document.getElementById('font-size-adjusted').textContent}\n`;
            textReport += `Touch Support:     ${document.getElementById('touch-support').textContent}\n\n`;
            
            // Usage Statistics
            textReport += "USAGE STATISTICS\n";
            textReport += "-----------------------------------------------\n";
            textReport += `Time on Page:      ${document.getElementById('time-on-page').textContent}\n`;
            textReport += `Reading Speed:     ${document.getElementById('reading-speed').textContent}\n`;
            textReport += `Timezone & Time:   ${document.getElementById('timezone-info').textContent}\n`;
            textReport += `Mouse Activity:    ${document.getElementById('mouse-activity').textContent}\n\n`;
            
            // Plugins
            textReport += "BROWSER PLUGINS\n";
            textReport += "-----------------------------------------------\n";
            if (navigator.plugins && navigator.plugins.length > 0) {
                for (let i = 0; i < navigator.plugins.length; i++) {
                    textReport += `${navigator.plugins[i].name}\n`;
                }
            } else {
                textReport += "No plugins detected or plugin information is restricted\n";
            }
            
            textReport += "\n===============================================\n";
            textReport += "Generated by InfoScope-DW • Your comprehensive browser and system information\n";
            textReport += "© 2025 InfoScope-DW. All rights reserved.\n";
            
            // Create a Blob with the text content
            const blob = new Blob([textReport], { type: 'text/plain' });
            
            // Create a download link and trigger it
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'InfoScope-DW-System-Report.txt';
            document.body.appendChild(a);
            a.click();
            
            // Clean up
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
        }
        
        // Add event listeners to download buttons
        document.getElementById('download-pdf-btn').addEventListener('click', generatePDF);
        document.getElementById('download-text-btn').addEventListener('click', generateTextReport);
        
        // Update browser size on window resize
        window.addEventListener('resize', getBrowserSize);

        // Initialize all information when the page loads
        // Dark mode functionality
        function initDarkMode() {
            const themeToggle = document.getElementById('theme-toggle');
            const moonIcon = document.getElementById('moon-icon');
            const sunIcon = document.getElementById('sun-icon');
            
            // Check if user has previously set a preference
            const prefersDarkMode = localStorage.getItem('darkMode') === 'true';
            const prefersLightMode = localStorage.getItem('darkMode') === 'false';
            
            // Check if user's system prefers dark mode
            const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            // Set initial state based on preference
            if (prefersDarkMode || (prefersDarkScheme && !prefersLightMode)) {
                document.body.setAttribute('data-theme', 'dark');
                moonIcon.style.display = 'none';
                sunIcon.style.display = 'block';
            }
            
            // Toggle dark mode
            themeToggle.addEventListener('click', () => {
                if (document.body.getAttribute('data-theme') === 'dark') {
                    document.body.removeAttribute('data-theme');
                    moonIcon.style.display = 'block';
                    sunIcon.style.display = 'none';
                    localStorage.setItem('darkMode', 'false');
                } else {
                    document.body.setAttribute('data-theme', 'dark');
                    moonIcon.style.display = 'none';
                    sunIcon.style.display = 'block';
                    localStorage.setItem('darkMode', 'true');
                }
            });
        }
        
        // Initialize charts
        function initializeCharts() {
            // Determine if we're in dark mode
            const isDarkMode = document.documentElement.getAttribute('data-theme') === 'dark';
            const textColor = isDarkMode ? '#FFFFFF' : getComputedStyle(document.documentElement).getPropertyValue('--text-color');
            const gridColor = isDarkMode ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';
            
            // Browser usage chart
            const browserChartOptions = {
                series: [65, 14, 12, 5, 3, 1], // Global browser market share (approximate)
                chart: {
                    type: 'donut',
                    height: 250,
                    fontFamily: 'Share Tech Mono, monospace',
                    foreColor: textColor,
                    animations: {
                        enabled: true,
                        dynamicAnimation: {
                            enabled: true
                        }
                    },
                    dropShadow: {
                        enabled: false
                    },
                    textShadow: {
                        enabled: false
                    }
                },
                labels: ['Chrome', 'Safari', 'Firefox', 'Edge', 'Opera', 'Other'],
                colors: [
                    '#4285F4', // Chrome blue
                    '#34A853', // Safari green
                    '#FF9900', // Firefox orange
                    '#0078D7', // Edge blue
                    '#FF1B2D', // Opera red
                    '#AAAAAA'  // Other gray
                ],
                title: {
                    text: 'Global Browser Market Share (2025)',
                    align: 'center',
                    style: {
                        fontSize: '14px',
                        fontFamily: 'Share Tech Mono, monospace',
                        fontWeight: isDarkMode ? 'bold' : 'normal',
                        color: textColor,
                        textShadow: 'none'
                    }
                },
                legend: {
                    position: 'right',
                    fontFamily: 'Share Tech Mono, monospace',
                    labels: {
                        colors: textColor,
                        useSeriesColors: false
                    },
                    markers: {
                        width: 12,
                        height: 12,
                        strokeWidth: 0,
                        radius: 12,
                        offsetX: 0,
                        offsetY: 0
                    },
                    itemMargin: {
                        horizontal: 5,
                        vertical: 4
                    },
                    onItemClick: {
                        toggleDataSeries: true
                    }
                },
                plotOptions: {
                    pie: {
                        donut: {
                            labels: {
                                show: true,
                                name: {
                                    show: true,
                                    color: textColor
                                },
                                value: {
                                    show: true,
                                    color: textColor
                                },
                                total: {
                                    show: true,
                                    color: textColor
                                }
                            }
                        }
                    }
                },
                stroke: {
                    width: isDarkMode ? 2 : 1,
                    colors: isDarkMode ? Array(6).fill('rgba(255, 255, 255, 0.2)') : Array(6).fill('rgba(0, 0, 0, 0.1)')
                },
                dataLabels: {
                    style: {
                        colors: [textColor],
                        fontSize: '12px',
                        fontFamily: 'Share Tech Mono, monospace',
                        fontWeight: 'normal',
                        textShadow: 'none'
                    },
                    background: {
                        enabled: true,
                        foreColor: textColor,
                        borderRadius: 2,
                        padding: 4,
                        opacity: isDarkMode ? 0.7 : 0.5,
                        borderWidth: 1,
                        borderColor: isDarkMode ? 'rgba(255, 255, 255, 0.15)' : 'rgba(0, 0, 0, 0.1)'
                    }
                },
                responsive: [{
                    breakpoint: 480,
                    options: {
                        chart: {
                            height: 250
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }]
            };

            const browserChart = new ApexCharts(document.querySelector("#browser-chart"), browserChartOptions);
            browserChart.render();
            
            // Hardware performance chart - uses realtime values from the user's system
            
            // We'll use real data where available
            const cpuCores = navigator.hardwareConcurrency || 4;
            let memoryGB = 4; // default fallback
            if ('deviceMemory' in navigator) {
                memoryGB = navigator.deviceMemory;
            }
            
            // Get connection data if available
            let downloadSpeed = 50; // default fallback in Mbps
            if ('connection' in navigator && navigator.connection.downlink > 0) {
                downloadSpeed = navigator.connection.downlink;
            }
            
            const performanceChartOptions = {
                series: [{
                    name: 'Your System',
                    data: [cpuCores, memoryGB, downloadSpeed]
                }, {
                    name: 'Average System',
                    data: [6, 8, 100]
                }],
                chart: {
                    type: 'bar',
                    height: 250,
                    fontFamily: 'Share Tech Mono, monospace',
                    foreColor: textColor,
                    animations: {
                        enabled: true,
                        dynamicAnimation: {
                            enabled: true
                        }
                    },
                    dropShadow: {
                        enabled: false
                    },
                    textShadow: {
                        enabled: false
                    }
                },
                colors: ['#5d8adb', '#a0a0a0'],
                plotOptions: {
                    bar: {
                        horizontal: false,
                        columnWidth: '55%',
                        borderRadius: 4
                    },
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    show: true,
                    width: 2,
                    colors: ['transparent']
                },
                xaxis: {
                    categories: ['CPU Cores', 'RAM (GB)', 'Download Speed (Mbps)'],
                    labels: {
                        style: {
                            colors: Array(3).fill(textColor),
                            fontFamily: 'Share Tech Mono, monospace'
                        }
                    },
                    axisBorder: {
                        show: true,
                        color: gridColor
                    },
                    axisTicks: {
                        show: true,
                        color: gridColor
                    }
                },
                yaxis: {
                    title: {
                        text: 'Value',
                        style: {
                            color: textColor,
                            fontFamily: 'Share Tech Mono, monospace'
                        }
                    },
                    labels: {
                        style: {
                            colors: [textColor],
                            fontFamily: 'Share Tech Mono, monospace'
                        }
                    }
                },
                title: {
                    text: 'Hardware Performance Comparison',
                    align: 'center',
                    style: {
                        fontSize: '14px',
                        fontFamily: 'Share Tech Mono, monospace',
                        fontWeight: isDarkMode ? 'bold' : 'normal',
                        color: textColor,
                        textShadow: 'none'
                    }
                },
                legend: {
                    position: 'top',
                    fontFamily: 'Share Tech Mono, monospace',
                    labels: {
                        colors: textColor,
                        useSeriesColors: false
                    },
                    markers: {
                        width: 12,
                        height: 12,
                        strokeWidth: 0,
                        radius: 3,
                        offsetX: 0,
                        offsetY: 0
                    },
                    itemMargin: {
                        horizontal: 5,
                        vertical: 4
                    },
                    onItemClick: {
                        toggleDataSeries: true
                    }
                },
                grid: {
                    borderColor: gridColor,
                    row: {
                        colors: [isDarkMode ? 'rgba(255, 255, 255, 0.02)' : 'rgba(0, 0, 0, 0.02)']
                    }
                },
                tooltip: {
                    theme: isDarkMode ? 'dark' : 'light',
                    style: {
                        fontSize: '12px',
                        fontFamily: 'Share Tech Mono, monospace'
                    },
                    y: {
                        formatter: function (val) {
                            return val.toString()
                        }
                    },
                    marker: {
                        show: true
                    }
                }
            };

            const performanceChart = new ApexCharts(document.querySelector("#performance-chart"), performanceChartOptions);
            performanceChart.render();
            
            // Update chart colors when theme changes
            document.getElementById('theme-toggle').addEventListener('click', () => {
                setTimeout(() => {
                    // After theme is toggled, reinitialize charts to reflect the new theme
                    
                    // First destroy existing charts if they exist
                    if (browserChart) {
                        browserChart.destroy();
                    }
                    if (performanceChart) {
                        performanceChart.destroy();
                    }
                    
                    // Reinitialize charts with updated theme
                    initializeCharts();
                    
                }, 200); // Small delay to ensure theme has changed
            });
        }
        
        // Function to get browser cache information
        function getBrowserCacheInfo() {
            const tabsCacheContainer = document.getElementById('tabs-cache-info');
            const cacheStorageSummary = document.getElementById('cache-storage-summary');
            
            // Feature detection for Cache API
            if ('caches' in window) {
                caches.keys().then(cacheNames => {
                    if (cacheNames.length === 0) {
                        tabsCacheContainer.innerHTML = 
                            `<div class="tabs-cache-item">No browser caches found</div>`;
                        return;
                    }
                    
                    let totalCacheSize = 0;
                    let cacheHTML = '';
                    let cachePromises = [];
                    
                    // Process each cache store
                    cacheNames.forEach(cacheName => {
                        const cachePromise = caches.open(cacheName)
                            .then(cache => {
                                return cache.matchAll().then(responses => {
                                    let cacheSize = 0;
                                    let active = true;
                                    
                                    // For simplicity, consider the cache active if it has items
                                    if (responses.length === 0) {
                                        active = false;
                                    }
                                    
                                    // Estimate size based on responses
                                    const sizePromises = responses.map(response => {
                                        return response.clone().blob().then(blob => {
                                            return blob.size;
                                        }).catch(() => 0);
                                    });
                                    
                                    return Promise.all(sizePromises).then(sizes => {
                                        cacheSize = sizes.reduce((acc, size) => acc + size, 0);
                                        totalCacheSize += cacheSize;
                                        
                                        // Create HTML item for this cache
                                        return {
                                            name: cacheName,
                                            size: formatBytes(cacheSize),
                                            active: active,
                                            items: responses.length
                                        };
                                    });
                                });
                            }).catch(err => {
                                console.error('Error accessing cache:', err);
                                return {
                                    name: cacheName,
                                    size: 'Unknown',
                                    active: false,
                                    items: 0,
                                    error: true
                                };
                            });
                            
                        cachePromises.push(cachePromise);
                    });
                    
                    // When all caches are processed
                    Promise.all(cachePromises).then(cacheDetails => {
                        cacheDetails.forEach(cache => {
                            const stateClass = cache.active ? 'state-active' : 'state-inactive';
                            const stateText = cache.active ? 'Active' : 'Inactive';
                            
                            cacheHTML += `
                                <div class="tabs-cache-item">
                                    <span class="tabs-cache-name">${cache.name}</span>
                                    <span class="tabs-cache-state ${stateClass}">${stateText}</span>
                                    <span class="tabs-cache-size">${cache.size}</span>
                                    <div>Contains ${cache.items} item${cache.items !== 1 ? 's' : ''}</div>
                                    ${cache.error ? '<div style="color: #f87171;">Error accessing this cache</div>' : ''}
                                </div>
                            `;
                        });
                        
                        tabsCacheContainer.innerHTML = cacheHTML;
                        cacheStorageSummary.textContent = `Total Browser Cache: ${formatBytes(totalCacheSize)} across ${cacheNames.length} cache${cacheNames.length !== 1 ? 's' : ''}`;
                    }).catch(err => {
                        console.error('Error processing caches:', err);
                        tabsCacheContainer.innerHTML = 
                            `<div class="tabs-cache-item">Error accessing browser caches</div>`;
                    });
                }).catch(err => {
                    console.error('Error listing caches:', err);
                    tabsCacheContainer.innerHTML = 
                        `<div class="tabs-cache-item">Error accessing browser caches: ${err.message}</div>`;
                });
            } else {
                // Browser doesn't support Cache API
                tabsCacheContainer.innerHTML = 
                    `<div class="tabs-cache-item">
                        Your browser doesn't support the Cache API, so detailed cache information cannot be shown.
                        <br><br>
                        <strong>Alternative information:</strong>
                        <div style="margin-top: 0.5rem;">
                            Cache Control Headers: ${document.querySelector('meta[http-equiv="cache-control"]')?.content || 'None detected'}
                        </div>
                        <div style="margin-top: 0.5rem;">
                            Estimated Storage Usage: Calculating...
                        </div>
                    </div>`;
                
                // Try to estimate using the Storage API
                if ('storage' in navigator && 'estimate' in navigator.storage) {
                    navigator.storage.estimate().then(estimate => {
                        const usage = formatBytes(estimate.usage || 0);
                        const quota = formatBytes(estimate.quota || 0);
                        const percent = estimate.quota ? Math.round((estimate.usage / estimate.quota) * 100) : 0;
                        
                        cacheStorageSummary.innerHTML = 
                            `Storage Usage: ${usage} of ${quota} (${percent}% used)`;
                    }).catch(err => {
                        console.error('Storage estimation error:', err);
                        cacheStorageSummary.textContent = 'Storage information unavailable';
                    });
                } else {
                    cacheStorageSummary.textContent = 'Browser storage information unavailable';
                }
            }
        }
        
        // Format bytes to human-readable string
        function formatBytes(bytes, decimals = 2) {
            if (bytes === 0 || !bytes) return '0 Bytes';
            
            const k = 1024;
            const dm = decimals < 0 ? 0 : decimals;
            const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
            
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            
            return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
        }
        
        // Initialize all functions
        function initializeInfo() {
            // Initialize browser cache dashboard
            getBrowserCacheInfo();
            
            // Load system information
            loadIpInfo();
            detectOS();
            detectBrowser();
            getResolution();
            getBrowserSize();
            getColorDepth();
            trackPageViews();
            getSupportedLanguages();
            checkPdfViewer();
            listPlugins();
            
            // Load hardware information
            getBatteryStatus();
            getDeviceMemory();
            getCPUCores();
            getConnectionType();
            detectNetworkInfo(); // New detailed network info
            
            // Load browser capabilities
            checkWebGLSupport();
            getGraphicsCardInfo();
            checkMediaSupport();
            checkWebRTCSupport();
            
            // Load privacy & security information
            checkDoNotTrack();
            detectAdBlocker();
            detectIncognitoMode();
            checkCookiesEnabled();
            checkCacheStorage();
            checkLocalStorageSize();
            checkIndexedDBSupport();
            
            // Load accessibility information
            detectColorScheme();
            detectReducedMotion();
            detectFontSizeAdjusted();
            detectTouchSupport();
            
            // Update time on page counter
            updateTimeOnPage();
            
            // Initialize timezone and mouse activity tracking
            getTimezoneInfo();
            trackMouseActivity();
            
            // Initialize charts
            initializeCharts();
            
            // Initialize dark mode
            initDarkMode();
            
            // Set up event listeners for window resize
            window.addEventListener('resize', getBrowserSize);
        }
        
        document.addEventListener('DOMContentLoaded', initializeInfo);
    </script>
</body>
</html>
